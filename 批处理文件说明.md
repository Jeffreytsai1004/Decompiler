# 批处理文件使用说明

本项目包含三个批处理文件，用于简化构建和运行流程。

## 📦 Build.bat - 构建脚本

**用途：** 完整构建项目，包括编译C++程序和打包GUI应用程序

**执行步骤：**
1. 检查环境（Python、CMake、MSBuild）
2. 安装Python依赖包
3. 编译C++核心程序（pycdc.exe、pycdas.exe）
4. 使用PyInstaller打包GUI应用程序

**生成文件：**
- `build/Release/pycdc.exe` - Python反编译器
- `build/Release/pycdas.exe` - Python字节码反汇编器
- `dist/Python反编译工具.exe` - 打包的GUI应用程序

**使用场景：**
- 首次构建项目
- 修改C++源码后重新编译
- 需要生成独立的exe文件

**注意事项：**
- 需要安装Visual Studio 2019或2022
- 每次构建会清空build和dist目录
- 使用系统Python进行打包，无需embed包

---

## 🚀 Run.bat - 运行脚本

**用途：** 快速启动应用程序（优先使用打包版本）

**执行逻辑：**
1. 检查是否存在打包的exe文件
   - **存在** → 直接启动打包版本
   - **不存在** → 使用Python脚本运行（开发模式）

**使用场景：**
- 日常使用应用程序
- 测试打包后的exe文件
- 快速启动（不需要看调试信息）

**特点：**
- 后台启动，不阻塞控制台
- 自动检查并安装依赖
- 智能切换打包版本和开发模式

---

## 🐛 RunDebug.bat - 调试脚本

**用途：** 开发调试模式，显示详细的控制台输出

**执行逻辑：**
1. 直接使用Python运行GUI脚本
2. 保持控制台窗口打开
3. 显示所有print输出和错误信息

**使用场景：**
- 开发和调试GUI界面
- 查看程序运行时的输出信息
- 排查错误和异常
- 修改代码后快速测试

**特点：**
- 控制台显示所有调试信息
- 可以看到实时的print输出
- 关闭GUI窗口后显示退出状态
- 无需重新打包，修改代码后直接运行

---

## 📋 使用流程

### 首次使用
```batch
1. 运行 Build.bat      # 构建项目
2. 运行 Run.bat        # 启动应用程序
```

### 开发调试
```batch
1. 修改 decompiler_gui.py 或其他Python文件
2. 运行 RunDebug.bat   # 直接测试，无需重新构建
```

### 修改C++代码
```batch
1. 修改 C++ 源文件
2. 运行 Build.bat      # 重新编译
3. 运行 Run.bat        # 测试
```

### 发布版本
```batch
1. 运行 Build.bat      # 完整构建
2. 分发 dist/Python反编译工具.exe
```

---

## ⚙️ 环境要求

### 必需软件
- **Python 3.6+** - 运行Python脚本和PyInstaller
- **CMake** - 生成C++项目文件
- **Visual Studio 2019/2022** - 编译C++代码（需要MSBuild）

### Python依赖包
- pyinstaller >= 5.11.0
- customtkinter >= 5.2.0
- darkdetect >= 0.7.1
- packaging >= 23.0
- pillow（用于图标转换）

---

## 🔧 常见问题

### Q: Build.bat报错找不到MSBuild？
**A:** 需要安装Visual Studio 2019或2022，并确保安装了C++开发工具。

### Q: 打包后的exe文件很大？
**A:** 这是正常的，PyInstaller会打包所有依赖。如果需要减小体积，可以考虑使用虚拟环境。

### Q: Run.bat启动后立即关闭？
**A:** 检查是否存在pycdc.exe，如果不存在请先运行Build.bat。

### Q: RunDebug.bat显示找不到模块？
**A:** 运行 `pip install -r requirements.txt` 安装依赖。

### Q: 不需要python目录了吗？
**A:** 是的，现在使用系统Python进行打包，不再需要embed包。

---

## 📝 技术说明

### 构建系统
- **C++编译：** CMake + MSBuild
- **Python打包：** PyInstaller（单文件模式）
- **依赖管理：** requirements.txt

### 目录结构
```
Decompiler/
├── build/              # C++编译输出（自动生成）
├── dist/               # 打包输出（自动生成）
├── icon/               # 应用程序图标
├── Build.bat           # 构建脚本
├── Run.bat             # 运行脚本
├── RunDebug.bat        # 调试脚本
├── decompiler_gui.py   # GUI主程序
├── decompiler.spec     # PyInstaller配置
└── requirements.txt    # Python依赖
```

---

## 💡 提示

- 开发时使用 **RunDebug.bat**，可以看到详细输出
- 测试时使用 **Run.bat**，模拟用户使用场景
- 发布前使用 **Build.bat**，生成独立的exe文件
- 修改Python代码无需重新构建，直接运行即可
- 修改C++代码需要重新运行Build.bat
